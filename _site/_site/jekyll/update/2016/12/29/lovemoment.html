<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>社区react native iOS 端常见问题与解决方案</title>
  <meta name="description" content="一、搭建环境 参考地址-中文">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/jekyll/update/2016/12/29/lovemoment.html">
  <link rel="alternate" type="application/rss+xml" title="luozhong&#39;s blog" href="/feed.xml">
  
  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">

    <a class="site-title" href="/">luozhong&#39;s blog</a>

    <nav class="site-nav">
      <span class="menu-icon">
        <svg viewBox="0 0 18 15" width="18px" height="15px">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </span>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">社区react native iOS 端常见问题与解决方案</h1>
    <p class="post-meta"><time datetime="2016-12-29T11:36:34+08:00" itemprop="datePublished">Dec 29, 2016</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h3 id="一搭建环境">一、搭建环境</h3>
<p><a href="http://reactnative.cn/">参考地址-中文</a></p>

<p><a href="http://facebook.github.io/react-native/">参考地址-官网</a></p>

<h4 id="需要资源">需要资源</h4>

<p>硬件</p>

<div class="highlighter-rouge"><pre class="highlight"><code>mac 电脑 ##### 软件

xcode 	
nodejs
Homebrew //Mac系统的包管理器，用于安装NodeJS和一些其他必需的工具软件。
Yarn	//React Native的命令行工具（react-native-cli）
Watchman	//由Facebook提供的监视文件系统变更的工具。安装此工具可以提高开发时的性能（packager可以快速捕捉文件的变化从而实现实时刷新）。
Flow	//静态的JS类型检查工具
</code></pre>
</div>

<h4 id="安装环境">安装环境</h4>

<h5 id="安装homebrew">安装Homebrew</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
</code></pre>
</div>

<p>在Max OS X 10.11（El Capitan)版本中，homebrew在安装软件时可能会碰到/usr/local目录不可写的权限问题。可以使用下面的命令修复：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo chown -R `whoami` /usr/local
</code></pre>
</div>

<h5 id="配置node源">配置node源</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>npm config set registry https://registry.npm.taobao.org --global
npm config set disturl https://npm.taobao.org/dist --global
</code></pre>
</div>

<h5 id="安装yarn">安装Yarn</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>npm install -g yarn react-native-cli
</code></pre>
</div>

<p>如果你看到<code class="highlighter-rouge">EACCES: permission denied</code>这样的权限报错，那么请参照上文的homebrew译注，修复/usr/local目录的所有权：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo chown -R `whoami` /usr/local
</code></pre>
</div>

<h5 id="安装xcode">安装xcode</h5>

<p><a href="https://developer.apple.com/xcode/">下载xcode</a></p>

<p>下载完成后执行默认安装即可</p>

<h5 id="安装watchman">安装Watchman</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>brew install watchman
</code></pre>
</div>

<h5 id="安装flow">安装Flow</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>brew install flow
</code></pre>
</div>

<h3 id="二新建工程">二、新建工程</h3>

<p>在目标文件夹中输入命令，初次执行此命令时间稍长</p>

<div class="highlighter-rouge"><pre class="highlight"><code>react-native init AwesomeProject //初始化一个名为 AwesomeProject 的项目
</code></pre>
</div>

<h3 id="模拟器运行项目">模拟器运行项目</h3>

<h5 id="启动项目两种方式">启动项目（两种方式）</h5>

<p>1、命令启动方式进入项目目录执行  <code class="highlighter-rouge">react-native run-ios</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code>cd AwesomeProject &amp;&amp; react-native run-ios
</code></pre>
</div>

<p>2、xcode启动项目</p>

<p>双击打开工程目录下 <code class="highlighter-rouge">ios/AwesomeProject.xcodeproj</code>文件，这个文件是iOS工程文件。</p>

<p>功能简介：</p>

<ul>
  <li>🔨图标表示运行设备，模拟器或者真机，需要手动选择（目前只能选择模拟器）</li>
  <li>左上角三角形<code class="highlighter-rouge">run</code></li>
  <li>黑色正方形：停止run</li>
</ul>

<p>选择一个模拟器</p>

<p>点击黑色三角形即可运行项目</p>

<image src="http://ois2zrmyi.bkt.clouddn.com/xcode1.jpeg" />

<h3 id="三调试">三、调试</h3>

<p>聚焦到模拟器上</p>

<p>选择左上角 <code class="highlighter-rouge">Hardware/Shake Gesture</code> 此时会在模拟器上呼出调试面板</p>

<image src="http://ois2zrmyi.bkt.clouddn.com/xcode2.jpeg" />

<image width="300px" src="http://ois2zrmyi.bkt.clouddn.com/xcode3.jpeg" />

<ul>
  <li>点击 <strong>Debug JS</strong> 浏览器会自动打开 <code class="highlighter-rouge">http://localhost:8081/debugger-ui</code> 页面，任何在react antive中的console即可在这个页面的控制台展示</li>
  <li><strong>Enable Live Reload</strong> 开启自动刷新页面功能，项目中保存后页面自动刷新</li>
</ul>

<h3 id="四模拟器基本操作快捷键">四、模拟器基本操作快捷键</h3>

<ul>
  <li><code class="highlighter-rouge">cmd + r</code>键刷新模拟器页面</li>
  <li><code class="highlighter-rouge">cmd + shift + h</code> 回到主页（相当于真机按下home键）</li>
  <li><code class="highlighter-rouge">cmd + shift + h + h</code> 快速点击两次 h （相当于双击home键）</li>
</ul>

<h3 id="真机运行">真机运行</h3>

<ul>
  <li><a href="https://idmsa.apple.com/IDMSWebAuth/login?appIdKey=891bd3417a7776362562d2197f89480a8547b108fd934911bcbea0110d07f757&amp;path=%2Faccount%2F&amp;rv=1">注册开发者账号</a></li>
  <li>双击打开工程目录下 <code class="highlighter-rouge">ios/AwesomeProject.xcodeproj</code>文件启动xcode</li>
  <li>将手机连接到电脑，并在手机弹框上点击 <strong>信任</strong></li>
  <li>单击左侧栏工程名，打开控制面板，选择 <code class="highlighter-rouge">General</code>下的 <code class="highlighter-rouge">Signing</code>，勾选<code class="highlighter-rouge">Autimatically manage signing</code></li>
  <li>在 <code class="highlighter-rouge">Team</code> 选项中选择 <code class="highlighter-rouge">add an account</code> 添加自己的开发者账号</li>
</ul>
<image src="http://ois2zrmyi.bkt.clouddn.com/xcode4.jpeg" />

<ul>
  <li>在左上角黑色正方形旁边的设备中选择连接电脑的iphone名称，中间顶部状态栏会展示当前设备准备情况。</li>
</ul>
<image src="http://ois2zrmyi.bkt.clouddn.com/xcode5.jpeg" />

<ul>
  <li>当设备准备就绪后 点击黑色三角形或者按下<code class="highlighter-rouge">cmd + r</code>键运行程序，随后手机上即可安装</li>
  <li>安装ok后点击图标启动app，如果弹出需要信任证书则进入 <code class="highlighter-rouge">系统设置-通用-设备管理</code>中找到相关证书，点击验证即可*</li>
  <li>进入app界面后摇晃手机即可呼出开发者面板，即可选择<strong>自动刷新</strong>或者 <strong>调试模式</strong></li>
</ul>

<p><strong><em>温馨提示：摇晃手机记得拿稳</em></strong></p>

<h3 id="五真机运行-切换运行模式">五、真机运行-切换运行模式</h3>

<p>运行模式分为<strong>debug</strong> 和 <strong>release</strong> 两种</p>

<h5 id="debug即程序调试时候此时应用运行基于我们的未打包的js文件可实时修改预览">debug即程序调试时候，此时应用运行基于我们的未打包的js文件，可实时修改预览</h5>

<h5 id="release即发布xcode会自动打包js文件">release即发布，xcode会自动打包js文件</h5>

<p>同时按下 <code class="highlighter-rouge">cmd + shift + ,</code>三个键 唤起设置界面</p>

<image src="http://ois2zrmyi.bkt.clouddn.com/xcode11.jpeg" />

<h4 id="真机调试报错情况">真机调试报错情况</h4>

<h5 id="1-在运行release模式的时候-出现如下错误删除这个test文件再运行即可">1. 在运行release模式的时候 出现如下错误，删除这个test文件再运行即可</h5>

<image width="300px" src="http://ois2zrmyi.bkt.clouddn.com/xcode8.jpeg" />

<h5 id="2-运行debug时出现以下错误需要clean同时按下-shift--cmd--k-完成清除">2. 运行debug时出现以下错误，需要clean，同时按下 <code class="highlighter-rouge">shift + cmd + k</code> 完成清除</h5>

<image width="300px" src="http://ois2zrmyi.bkt.clouddn.com/xcode12.jpeg" />

<h3 id="五修改iconappname和启动画面">五、修改icon，appname和启动画面</h3>

<h4 id="修改icon">修改icon</h4>

<ul>
  <li>appstore 搜索 <strong>Prepo</strong> 下载安装</li>
  <li>启动<strong>Prepo</strong> 将需要的图标（一张原图）拖放到软件中即可生成全部类型的icon，导出即可</li>
  <li>xcode中打开项目</li>
</ul>
<image width="100%" src="http://ois2zrmyi.bkt.clouddn.com/xcode6.jpeg" />

<ul>
  <li>将导出的icon拖到对应的地方，2x、3x表示倍数。大小为像素，例如第一个图标为 20x2=40像素 的图标</li>
  <li>重新运行项目即可看到图标
 </li>
</ul>

<h4 id="修改appname">修改appName</h4>

<ul>
  <li>修改info.plist文件，新建名为 <code class="highlighter-rouge">Bundle display name</code> 的key，值为 app的名字，这个值在发布 ipa包的时候需要</li>
  <li>修改 <code class="highlighter-rouge">Bundle name</code> 值为 app的名字，在真机运行的时候需要</li>
</ul>
<image width="100%" src="http://ois2zrmyi.bkt.clouddn.com/xcode7.jpeg" />

<ul>
  <li>再次运行项目即可看到更新的应用名</li>
</ul>

<h4 id="修改app-transport-security-settings">修改App Transport Security Settings</h4>

<p>添加方法参考上文  <strong><em>修改appName</em></strong></p>

<p>iOS 10 添加了https安全策略 为了继续使用 http 需要做以下修改</p>

<div class="highlighter-rouge"><pre class="highlight"><code>App Transport Security Settings 添加 Allow Arbitrary Loads 布尔值 YES
</code></pre>
</div>

<image width="100%" src="http://ois2zrmyi.bkt.clouddn.com/xcode9.jpeg" />

<h4 id="webview调用相机闪退">WebView调用相机闪退</h4>

<p>在info.plist文件下添加如下key</p>

<div class="highlighter-rouge"><pre class="highlight"><code>相机权限

&lt;key&gt;NSCameraUsageDescription&lt;/key&gt;

&lt;string&gt;cameraDesciption&lt;/string&gt;	 

相册权限

&lt;key&gt;NSPhotoLibraryUsageDescription&lt;/key&gt;

&lt;string&gt;photoLibraryDesciption&lt;/string&gt;
</code></pre>
</div>

<image width="100%" src="http://ois2zrmyi.bkt.clouddn.com/xcode10.jpeg" />


  </div>

  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">luozhong&#39;s blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              luozhong&#39;s blog
            
            </li>
            
            <li><a href="mailto:luozhong0521@163.com">luozhong0521@163.com</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>...
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
